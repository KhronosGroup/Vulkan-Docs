// Copyright 2019-2025 The Khronos Group Inc.
//
// SPDX-License-Identifier: CC-BY-4.0

// Common Valid Usage
// Common to VkImageMemoryBarrier* structs
// This relies on the following additional attributes set by the command which
// includes this file:
//
//  - {imagelayoutnotignored}, a text that specifies when the image layout is not ignored.
  * [[VUID-{refpage}-oldLayout-01197]]
    If {imagelayoutnotignored} pname:oldLayout must: be
    ename:VK_IMAGE_LAYOUT_UNDEFINED or the current layout of the image
    subresources affected by the barrier
  * [[VUID-{refpage}-newLayout-01198]]
    If {imagelayoutnotignored} pname:newLayout must: not be
    ename:VK_IMAGE_LAYOUT_UNDEFINED or
ifdef::VK_EXT_zero_initialize_device_memory[ename:VK_IMAGE_LAYOUT_ZERO_INITIALIZED_EXT or]
    ename:VK_IMAGE_LAYOUT_PREINITIALIZED
  * [[VUID-{refpage}-image-09117]]
    If pname:image was created with a sharing mode of
    ename:VK_SHARING_MODE_EXCLUSIVE, and pname:srcQueueFamilyIndex and
    pname:dstQueueFamilyIndex are not equal, pname:srcQueueFamilyIndex must:
    be
ifdef::VK_BASE_VERSION_1_1,VK_KHR_external_memory[]
    ename:VK_QUEUE_FAMILY_EXTERNAL,
ifdef::VK_EXT_queue_family_foreign[]
    ename:VK_QUEUE_FAMILY_FOREIGN_EXT,
endif::VK_EXT_queue_family_foreign[]
    or
endif::VK_BASE_VERSION_1_1,VK_KHR_external_memory[]
    a valid queue family
  * [[VUID-{refpage}-image-09118]]
    If pname:image was created with a sharing mode of
    ename:VK_SHARING_MODE_EXCLUSIVE, and pname:srcQueueFamilyIndex and
    pname:dstQueueFamilyIndex are not equal, pname:dstQueueFamilyIndex must:
    be
ifdef::VK_BASE_VERSION_1_1,VK_KHR_external_memory[]
    ename:VK_QUEUE_FAMILY_EXTERNAL,
ifdef::VK_EXT_queue_family_foreign[]
    ename:VK_QUEUE_FAMILY_FOREIGN_EXT,
endif::VK_EXT_queue_family_foreign[]
    or
endif::VK_BASE_VERSION_1_1,VK_KHR_external_memory[]
    a valid queue family
ifdef::VK_BASE_VERSION_1_1,VK_KHR_external_memory[]
ifndef::VKSC_VERSION_1_0[]
  * [[VUID-{refpage}-None-09119]]
    {empty}
ifdef::VK_BASE_VERSION_1_1,VK_KHR_external_memory[If]
ifdef::VK_KHR_external_memory[]
    the apiext:VK_KHR_external_memory extension is not enabled,
endif::VK_KHR_external_memory[]
ifdef::VK_BASE_VERSION_1_1+VK_KHR_external_memory[and]
ifdef::VK_BASE_VERSION_1_1[]
    the value of slink:VkApplicationInfo::pname:apiVersion used to create
    the slink:VkInstance is not greater than or equal to Version 1.1,
endif::VK_BASE_VERSION_1_1[]
    pname:srcQueueFamilyIndex must: not be ename:VK_QUEUE_FAMILY_EXTERNAL
  * [[VUID-{refpage}-None-09120]]
    {empty}
ifdef::VK_BASE_VERSION_1_1,VK_KHR_external_memory[If]
ifdef::VK_KHR_external_memory[]
    the apiext:VK_KHR_external_memory extension is not enabled,
endif::VK_KHR_external_memory[]
ifdef::VK_BASE_VERSION_1_1+VK_KHR_external_memory[and]
ifdef::VK_BASE_VERSION_1_1[]
    the value of slink:VkApplicationInfo::pname:apiVersion used to create
    the slink:VkInstance is not greater than or equal to Version 1.1,
endif::VK_BASE_VERSION_1_1[]
    pname:dstQueueFamilyIndex must: not be ename:VK_QUEUE_FAMILY_EXTERNAL
endif::VKSC_VERSION_1_0[]
ifdef::VK_EXT_queue_family_foreign[]
  * [[VUID-{refpage}-srcQueueFamilyIndex-09121]]
    If the apiext:VK_EXT_queue_family_foreign extension is not enabled
    pname:srcQueueFamilyIndex must: not be ename:VK_QUEUE_FAMILY_FOREIGN_EXT
  * [[VUID-{refpage}-dstQueueFamilyIndex-09122]]
    If the apiext:VK_EXT_queue_family_foreign extension is not enabled
    pname:dstQueueFamilyIndex must: not be ename:VK_QUEUE_FAMILY_FOREIGN_EXT
endif::VK_EXT_queue_family_foreign[]
endif::VK_BASE_VERSION_1_1,VK_KHR_external_memory[]
// Common Valid Usage
